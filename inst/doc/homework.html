<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22036" />

<meta name="date" content="2022-12-09" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">22036</h4>
<h4 class="date">2022-12-09</h4>



<div id="a-22036-2022-09-09" class="section level1">
<h1>A-22036-2022-09-09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>A dataset of car information from different brands</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Cars93)</span></code></pre></div>
<pre><code>##     Manufacturer     Model         Type      Min.Price         Price      
##  Chevrolet: 8    100    : 1   Compact:16   Min.   : 6.70   Min.   : 7.40  
##  Ford     : 8    190E   : 1   Large  :11   1st Qu.:10.80   1st Qu.:12.20  
##  Dodge    : 6    240    : 1   Midsize:22   Median :14.70   Median :17.70  
##  Mazda    : 5    300E   : 1   Small  :21   Mean   :17.13   Mean   :19.51  
##  Pontiac  : 5    323    : 1   Sporty :14   3rd Qu.:20.30   3rd Qu.:23.30  
##  Buick    : 4    535i   : 1   Van    : 9   Max.   :45.40   Max.   :61.90  
##  (Other)  :57    (Other):87                                               
##    Max.Price       MPG.city      MPG.highway                  AirBags  
##  Min.   : 7.9   Min.   :15.00   Min.   :20.00   Driver &amp; Passenger:16  
##  1st Qu.:14.7   1st Qu.:18.00   1st Qu.:26.00   Driver only       :43  
##  Median :19.6   Median :21.00   Median :28.00   None              :34  
##  Mean   :21.9   Mean   :22.37   Mean   :29.09                          
##  3rd Qu.:25.3   3rd Qu.:25.00   3rd Qu.:31.00                          
##  Max.   :80.0   Max.   :46.00   Max.   :50.00                          
##                                                                        
##  DriveTrain  Cylinders    EngineSize      Horsepower         RPM      
##  4WD  :10   3     : 3   Min.   :1.000   Min.   : 55.0   Min.   :3800  
##  Front:67   4     :49   1st Qu.:1.800   1st Qu.:103.0   1st Qu.:4800  
##  Rear :16   5     : 2   Median :2.400   Median :140.0   Median :5200  
##             6     :31   Mean   :2.668   Mean   :143.8   Mean   :5281  
##             8     : 7   3rd Qu.:3.300   3rd Qu.:170.0   3rd Qu.:5750  
##             rotary: 1   Max.   :5.700   Max.   :300.0   Max.   :6500  
##                                                                       
##   Rev.per.mile  Man.trans.avail Fuel.tank.capacity   Passengers   
##  Min.   :1320   No :32          Min.   : 9.20      Min.   :2.000  
##  1st Qu.:1985   Yes:61          1st Qu.:14.50      1st Qu.:4.000  
##  Median :2340                   Median :16.40      Median :5.000  
##  Mean   :2332                   Mean   :16.66      Mean   :5.086  
##  3rd Qu.:2565                   3rd Qu.:18.80      3rd Qu.:6.000  
##  Max.   :3755                   Max.   :27.00      Max.   :8.000  
##                                                                   
##      Length        Wheelbase         Width        Turn.circle   
##  Min.   :141.0   Min.   : 90.0   Min.   :60.00   Min.   :32.00  
##  1st Qu.:174.0   1st Qu.: 98.0   1st Qu.:67.00   1st Qu.:37.00  
##  Median :183.0   Median :103.0   Median :69.00   Median :39.00  
##  Mean   :183.2   Mean   :103.9   Mean   :69.38   Mean   :38.96  
##  3rd Qu.:192.0   3rd Qu.:110.0   3rd Qu.:72.00   3rd Qu.:41.00  
##  Max.   :219.0   Max.   :119.0   Max.   :78.00   Max.   :45.00  
##                                                                 
##  Rear.seat.room   Luggage.room       Weight         Origin              Make   
##  Min.   :19.00   Min.   : 6.00   Min.   :1695   USA    :48   Acura Integra: 1  
##  1st Qu.:26.00   1st Qu.:12.00   1st Qu.:2620   non-USA:45   Acura Legend : 1  
##  Median :27.50   Median :14.00   Median :3040                Audi 100     : 1  
##  Mean   :27.83   Mean   :13.89   Mean   :3073                Audi 90      : 1  
##  3rd Qu.:30.00   3rd Qu.:15.00   3rd Qu.:3525                BMW 535i     : 1  
##  Max.   :36.00   Max.   :22.00   Max.   :4105                Buick Century: 1  
##  NA&#39;s   :2       NA&#39;s   :11                                  (Other)      :87</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(<span class="fu">head</span>(Cars93))</span></code></pre></div>
<pre><code>## % latex table generated in R 4.2.2 by xtable 1.8-4 package
## % Fri Dec  9 11:36:17 2022
## \begin{table}[ht]
## \centering
## \begin{tabular}{rlllrrrrrlllrrrrlrrrrrrrrrll}
##   \hline
##  &amp; Manufacturer &amp; Model &amp; Type &amp; Min.Price &amp; Price &amp; Max.Price &amp; MPG.city &amp; MPG.highway &amp; AirBags &amp; DriveTrain &amp; Cylinders &amp; EngineSize &amp; Horsepower &amp; RPM &amp; Rev.per.mile &amp; Man.trans.avail &amp; Fuel.tank.capacity &amp; Passengers &amp; Length &amp; Wheelbase &amp; Width &amp; Turn.circle &amp; Rear.seat.room &amp; Luggage.room &amp; Weight &amp; Origin &amp; Make \\ 
##   \hline
## 1 &amp; Acura &amp; Integra &amp; Small &amp; 12.90 &amp; 15.90 &amp; 18.80 &amp;  25 &amp;  31 &amp; None &amp; Front &amp; 4 &amp; 1.80 &amp; 140 &amp; 6300 &amp; 2890 &amp; Yes &amp; 13.20 &amp;   5 &amp; 177 &amp; 102 &amp;  68 &amp;  37 &amp; 26.50 &amp;  11 &amp; 2705 &amp; non-USA &amp; Acura Integra \\ 
##   2 &amp; Acura &amp; Legend &amp; Midsize &amp; 29.20 &amp; 33.90 &amp; 38.70 &amp;  18 &amp;  25 &amp; Driver \&amp; Passenger &amp; Front &amp; 6 &amp; 3.20 &amp; 200 &amp; 5500 &amp; 2335 &amp; Yes &amp; 18.00 &amp;   5 &amp; 195 &amp; 115 &amp;  71 &amp;  38 &amp; 30.00 &amp;  15 &amp; 3560 &amp; non-USA &amp; Acura Legend \\ 
##   3 &amp; Audi &amp; 90 &amp; Compact &amp; 25.90 &amp; 29.10 &amp; 32.30 &amp;  20 &amp;  26 &amp; Driver only &amp; Front &amp; 6 &amp; 2.80 &amp; 172 &amp; 5500 &amp; 2280 &amp; Yes &amp; 16.90 &amp;   5 &amp; 180 &amp; 102 &amp;  67 &amp;  37 &amp; 28.00 &amp;  14 &amp; 3375 &amp; non-USA &amp; Audi 90 \\ 
##   4 &amp; Audi &amp; 100 &amp; Midsize &amp; 30.80 &amp; 37.70 &amp; 44.60 &amp;  19 &amp;  26 &amp; Driver \&amp; Passenger &amp; Front &amp; 6 &amp; 2.80 &amp; 172 &amp; 5500 &amp; 2535 &amp; Yes &amp; 21.10 &amp;   6 &amp; 193 &amp; 106 &amp;  70 &amp;  37 &amp; 31.00 &amp;  17 &amp; 3405 &amp; non-USA &amp; Audi 100 \\ 
##   5 &amp; BMW &amp; 535i &amp; Midsize &amp; 23.70 &amp; 30.00 &amp; 36.20 &amp;  22 &amp;  30 &amp; Driver only &amp; Rear &amp; 4 &amp; 3.50 &amp; 208 &amp; 5700 &amp; 2545 &amp; Yes &amp; 21.10 &amp;   4 &amp; 186 &amp; 109 &amp;  69 &amp;  39 &amp; 27.00 &amp;  13 &amp; 3640 &amp; non-USA &amp; BMW 535i \\ 
##   6 &amp; Buick &amp; Century &amp; Midsize &amp; 14.20 &amp; 15.70 &amp; 17.30 &amp;  22 &amp;  31 &amp; Driver only &amp; Front &amp; 4 &amp; 2.20 &amp; 110 &amp; 5200 &amp; 2565 &amp; No &amp; 16.40 &amp;   6 &amp; 189 &amp; 105 &amp;  69 &amp;  41 &amp; 28.00 &amp;  16 &amp; 2880 &amp; USA &amp; Buick Century \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Cars93)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Horsepower, <span class="at">y=</span>MPG.highway, <span class="at">main =</span> <span class="st">&quot;Horsepower-MPG.highway&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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llRGLWLGWPqsNowKd1YBISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAjQxQCpp01W+U87mVQICBACAjQPQI0ITj2+/Y48eeAPDOYRYipk9eNKBNLLdDwrfwgcy1ybecu3cxaAWGfZzeP084L5J+KJVWv2hOWt4KHS1ZzLkseLq1QiwrW8LghI3ivrbi8C5prFjj86sdG3ueKfshElH12l07HYseo3d/vD851O5XzsYqbmMIJEaCF95XeRk5dtyAg6FrIqIg8XOzPd8e3HFw864FflnUDzAcR6zTvJx9aW+xsmFdOrALFE1frw6n9vd9WyS3X7gKxRUAk74uoBYq/13Q/Ltnpzv+0iNW8ZkOGDVCf1cGpVEKuZrj28+DV1z0+f7zoutwzImMW20vfwS3d42CobOCym15zFxHNSGn7XZpXqpgHpdZB4ipcM6eUrHOqwD6vfrmRwr0wnLu2R4dEy1c0BCleJp3emCwEBQkCArgDQZYWAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgL0f77flGfbsZYXAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Cars93<span class="sc">$</span>Weight)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA2FBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kJA6kLY6kNtmAABmADpmOgBmOjpmOpBmZmZmkJBmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa2tma2tpC225C229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb////tmb/trb/25D/27b//7b//9v///9w7uEQAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMi0lEQVR4nO2d8YPathXHDT0K7NLlVri03ZZjaZYuOMvWXjKatFuHx4H///9o0nuSLeDE17J1gM37/nD4bL1n6YP0JNuySHLRQSWnzsC5SwABCSAgAQQkgIAEEJAAAhJAQAIISAABCSAgAQQkgIAEEJAAAhJAQAIISAABCSAgAQQkgIAEEJAAAhJAQAIISAABCSAgAQQkgIAEEJAAAuo8oNV43sgeAdrMksGSP4fFP87hv39sdPpHTvhulCQ39p9P10mSfHVfxe77JPniJW0+qM3enyijD98o++fLfD2lnK9GSW9Ohek7+d4v1oKSkZoBenjRjw0oUyVKJry9fpGwJtBMEdC6KTeHOQHRGiwNkox9qRRDxzYeoD2lSXRATt7UOa3ukFmqzHT6O+0hean/3FH+/jl+M1Kb7DZlcIrbYeQNa9DPqt73nt/z+QjRZ1WTv+BKvXmXJFdzIqdO8+ZF0r/PP+ua8NWcv7rP10nvZf7zSKUqT1M4IJcmd6qQVz+oajpL6LSFl9JxkROuE6rgKpPvn6nUK01F5XeyGr/VWc901SHiKmMZ0dM57d0sizJu5/wt/VcL0IK/VOXHAjJ7Bkv7rfeuy92DZcaHVbFN7U+Sa4vWfmPWgQOoiBSbv9z8x7Q9PmYdlznhOmEijTbRNYry+wsHaWK3nvZe6/0LJy9XH02x9nNOnisAsjKA9Je1zD9RY+Ympk7O3CZUjOFSZc+cZnCf/1tZfbnkIuhMTbQtNwJbz10HZe3ejhSOF+vYyQnvL5Bm/O1TQQva+pvq/6gTpvxVqCpIdgxoP+eUoXBAyufVT+YoAzKRKOVKpbdV1vk0Nnb8+v46oa9QZ4X/OoHAdVAC2o8Uxot17OSEYfJpDRiK1xTldTsl54tkqFsCtQaVdkIp+x8Z0H7OKUk4IN7DEYec2la44Dg5KA7YsuoemB0U5Ri65Xcd+AGVXmya7Zyok6dls/3Mxpv3IxPjVQV5qUKSJvJhynXOtllbrN2cUz5rxKAH7nx7fzPebFPQoc9uu4B0Oa7++uvUC8h1cKiJWS9FGicntrxFXLMd7Gr83chU2D9MlVmmAvyIPrcBPZLzuoBUxl5f25BaoQYVATSwBjlB+vm968VJU+REw+p9/aoc0JSA5pn5GhPz+cyEddv+Y9cg3v+qjDj+GETl4E7VBulHAHli0HY373hx09ickMjxwzejCTmjcKm6+flqxLmk5kntkgPhcKuM+zmvCUjl9GtqZ9TxaEf+XszWoMFSl9JXgzy92PZA0fHikLc5UWOY/j3vV1bq7ycz7um9Gb9NCYUO3BPnM9XDsYdpUXn2c163Br0rByQZGAc5sfRAkHbHQVu1o7jUuNnyUqTZyYkpeXF9UWxanNSo7KcZB5nh0u44qFETK68gafB5bwbCf2YDtev393u92NUPukP1AXIcbDcfPtVP217KNM61rB5nU3/OV6hbF6uUwI4B1KcJ8d+P+Jgzkt7KeSVANZXuXv6dTKG3O3ZzHhtQSu2BBvbnocqAPDmPDcgOL3ph39sZyJPz6E1M9bLmCrttejznnb/l2lQCCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBBQHEDFbNQG7hK/ouSxbrbOxl3yL58EEJsKIGAqgICpAAKmAgiYCiBgKoCAqQACpjUAHWFw2XJAT1/rBBDKVixHjd11ApB97c+7YseFA1rYdwQz3+IgHQa0s2TMY9rMypdMPS8UdhhQ+TqwV+tpsUpN5mlknQaUI0Ynq0F+HRsQI/KG4IVdrODIMajOkfoZOVAifqV8M/O+sWzX//Em6DIgXXguuC/ABLkLNz1zQOtpgxeVo9y0P3NAlbQwyzrki6P2YmcCKKUVPg519Ata+muYXyaglAIQl/9xcTdPMfwCAdlR4IEIbZMolBcIyI4CfUV3kuTp8AIBmVHganQgCFksxWpzB9yF5+TcAfFqRIf7ejuU3swuEdCJ3QkgZHrugODdwjB34abnDiiNsfJxhwGtp3hV6wB33gR17u2cCSC4qHWIO2+CuBiOCGgzG8Z0503QWkDqOjVCFeowoGKx8KftxdoL6EjuBBBK0GJAtJJ62qyz7zKgrDdf6IW5GxHqMCB9s2dx4F7hYS+Vb9q3F5AeKGpADZ755BdRg1LvQ8Egd94ErQVkYtCi2XCxy4B4qNhwmeNOAzqKOwGEErQWkFyLVStRs17+AgDl6TCqu70ErQckA0VQolqXGn53ewnaDujQ7I4YE8nbCwhOP8yjTCRvL6AKijENuNOAYkwkby+gYqDoDzEXXoP4sc/Bq/kIE8nbC2gz48L76gap+UTy9gJa3/KNDhkoekpka1CtO4qXcE9a31HMeSp0FHe+BO0FxAGm0R3pjgOCqjASuGxA/smt1d21GVCFR89wElGXAVV69IwmEXUYUKNHz/vuvAlaC0gePYMSyaNnVCJ59IxKJI+ea5Uosrv2AnLuhsVw503QWkAy0x6VqOFD5113vgStBSSTF2qWKLI7AYQStBNQnAiddxxQjI5eAHm8dP2mvdQgUCIBBEokgECJOgjIrzolqvBAJ8TdoQTHAuQ/ErlEkd0JIJRAAOX5oeUVBBD99ebueBj8RwQQOCKAwBEBBI4IIHBEAIEjAggcEUDgyFMCqvi2z8UCqvq2z6UCqvyuxqUC8r/ts3Oz5dC12On1dIAq1KDuKTAGobd9uqewClflvc2OKfI4qHt6EkCnDcJI5wCozqHTH4mRvLHT02MQQLWPxEje2OnpMQig2kdiJG/s9PQYBFDtIzGSN3Z6egwCqPaRGMkvTwIISAABCSAgAQQkgIAEEJAAAhJAQAIISAABCSAgAQQUCdDqd/pZPT9XHOb0y/W8hkPmW8yBZtJMAo0W5kCITW4Wrgu0sYoDaD2lyQyrsTmdXjCOFo0rNna1mam9C53fACO9dA8dCLDRiehJcJhNoSiAMjOlys754FkO6bDc2NNqROt+6hJXNqLFn2gRrIATmZW1Am1KxQCUJRM++8KcrCh9icFjqatRmBEBCrJZDF5pQMGZY0WKQQwofcZxhWuz2ldseMz0T5cGGtFCjyE26hDFoODMsWICWk8pIxPTsNXfYsNjpTIcZpRRGUNsdEPSgIIzZxS1BtnNinnIqE8JNNrM7Nybajbbq2pVP49VfECqaVerxe4srMpGTokq2dCBElDAeYyeANB4Xi12urPUqhrlNshWtVmYOS8hNluKCYjPqDar9KR2Ol+AUZE06EQ516BQG6u4vZg+mV7LE4/FViNbfwKMdEGpWAE21i7UxipuE0ttZbbXBOXGjkzVpz67slGZNMAmtzEozMZKLlaBBBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBBQGwCtv13iRE+lYwOi2b+DAwXef3Ce8tQ5fsDOk2bcnzPd+tGU4p8s0i+pHBsQT5pK/VMG9CGaqVJM+U37H779Re3hiTzpdzzn2bMClgUU7admjgzITH4qp9Htiktuf+9VVxRlopqYqj5ku759M3bnSe/btxuQXRvuf1QZeDrK+vZ1oudE0X/b8wZLQLlhlw3+OzPVi2bQTCwL5az3ujdfT/+oHN1pb4facYCOCmjrl5D1hCY9p5emn1L1yJI7A8jMPjOHf+MgTQZD+rC2ehoWAdLzibNEA9Izr/VnK2uQGzrWt3NuclwzzExBM2+QAPGU31zXhqE+lg2WG1V9zAf7UnaaBZulGsyEnHQAkFamWxWVxbzsYYO0qUEmVunXUHgGuKaq52GO7dw5w4L5ZqbmqD8tBbTVxFQI6f84MoC4+zfBpP/h1nnvhMZBugmpepPRJEX6yOz0VfoN5o4AKoJ0puPonW1itixF788vV+W2xSlAPN15Qu9bpEP9Ucy+7FINcrt5KlOWuICKrYXp1M3EeAWIZ6V+OaOdVy/unMRlDFq0HxAPFOldMa48iemF7LTc9XRo/rFTfqkX+03vzlfPxhx3qPLwWy2GSdmLWUCx1lI99qUGvfdnLhpUgWwBKaToEuvj5RVGEZ2GeV7EbDvM1OMgxaUYB/X/wV0a7UlbOQ6qqaoXq1F+SndXbQCExZch0ZqVq24A4k4/VlzeUkcAPZ0EEJAAAhJAQAIISAABCSAgAQQkgIAEEJAAAhJAQAIISAABCSAgAQQkgIAEEJAAAhJAQAII6P8Y+uyTsWf4RAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(<span class="fu">table</span>(Cars93<span class="sc">$</span>Type),<span class="at">main =</span> <span class="st">&quot;Car types in Car93&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="a-22036-2022-09-16" class="section level1">
<h1>A-22036-2022-09-16</h1>
<div id="section" class="section level2">
<h2>3.3</h2>
<div id="question-1" class="section level3">
<h3>QUESTION</h3>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x) = (\frac{b}{x})^a, x ≥ b &gt; 0,a &gt;
0.\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform
method to simulate a random sample from the Pareto(2, 2) distribution.
Graph the density histogram of the sample with the Pareto(2, 2) density
superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level3">
<h3>ANSWER</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>u) <span class="co"># F(x) = 1- (2/x)^2, 2&lt;=x</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">8</span>,x<span class="sc">^</span><span class="dv">3</span>)), <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">50</span>, .<span class="dv">01</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">8</span><span class="sc">/</span>(y<span class="sc">^</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="section-1" class="section level1">
<h1>3.7</h1>
<div id="question-2" class="section level3">
<h3>QUESTION</h3>
<p>Write a function to generate a random sample of size n from the
Beta(<span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>) distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the Beta(3, 2) distribution. Graph the histogram of the sample with the
theoretical Beta(3, 2) density superimposed.</p>
</div>
<div id="answer-2" class="section level3">
<h3>ANSWER</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g().</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">&gt;</span> u) {</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="co">#we accept x</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(j,y))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">ar_beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ans[[<span class="dv">1</span>]]<span class="sc">/</span>n<span class="co"># value of c</span></span></code></pre></div>
<pre><code>## [1] 11.644</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ans[[<span class="dv">2</span>]], <span class="at">prob=</span>T,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">Be</span>(<span class="dv">3</span>,<span class="dv">2</span>)), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">12</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>3.12</h2>
<div id="question-3" class="section level3">
<h3>QUESTION</h3>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has
Gamma(<span class="math inline">\(r\)</span>, <span class="math inline">\(\beta\)</span>) distribution and <span class="math inline">\(Y\)</span> has Exp(<span class="math inline">\(\Lambda\)</span>) distribution. That is, <span class="math inline">\((Y|\Lambda = \lambda) \sim f_Y(y|\lambda) =
\lambda e^{−\lambda y}\)</span>. Generate 1000 random observations from
this mixture with <span class="math inline">\(r\)</span> = 4 and <span class="math inline">\(β\)</span> = 2.</p>
</div>
<div id="answer-3" class="section level3">
<h3>ANSWER</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda) <span class="co"># the length of lambda = n</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;Mixture Distribution&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-3" class="section level2">
<h2>3.13</h2>
<div id="question-4" class="section level3">
<h3>QUESTION</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto
distribution with cdf <span class="math display">\[F(y) = 1 −
(\frac{\beta}{\beta + y}) ^ r, y ≥ 0.\]</span> (This is an alternative
parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000
random observations from the mixture with <span class="math inline">\(r\)</span> = 4 and <span class="math inline">\(\beta\)</span> = 2. Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level3">
<h3>ANSWER</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">64</span>,(<span class="dv">2</span><span class="sc">+</span>x)<span class="sc">^</span><span class="dv">5</span>)), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, .<span class="dv">01</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">64</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>y)<span class="sc">^</span><span class="dv">5</span> )</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmZmZmkLZmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtv+Q2/+2ZgC2Zjq2kGa2kJC227a22/+2/7a2///T09PbkDrbtpDb/9vb////tmb/tpD/25D/27b/29v//7b//9v///8CHdfDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJR0lEQVR4nO2diZbbNBhGPW0mXYAyKV2gYR1TKB1DTIqT938zLEt27Iylz4plW1K+ezh0MkkU+47WX0uSIzGSLH0BvkNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQIUNDh4zpJvtnVD/Pkw5SfFp6gwzYRrJSh/ZqCumTJ00/HL9vkrnokdFFQm8P2yefyn2JzWz3Mbn6hoA779V3rUVkBsQ7qUvr4+01ZSX8SD0Q+oqAuefKyqqSrgpaW/6egLnmSfLs7/vdzcivq6w9s5s/JZfMl6mpZHVFQl/1a+ihLV5Yobu6n+7zgBKn2XeQgCuolTV7tREfxVj1mETujeHNqxQQUdM7h93Kw+ir2werhj9+an//9fmd45cIsJOjLu0+tR/t3n7WvXJqZBYkKpCwRxdtuu7N/7q2hmQWlVZt82N6d/T5b+VrK5hWkYhXZo45Ld4zuE3MLEjml2DzKL8qch8wqKBcdGBGguJWPxD+pbKXTaRvry1lCUKrCpUKKklUOzG9N71yOBYrYYatyS7F58udGFa088bSaXkBQsamLU5a8qH/M1dghrQegMkMlI3BzyYsKOrSHnJ7W0osKKn+qtVBQRbcOKsvT+zoL1XXQWRFbniX6QXUrllctmpTFVqxCClJNeyFasP1a5pzMYT9ov07ctYkL9qRl5smq7OS0J527zIyLhDssx2Lt2JGBJqyUuhzXLSLosD3/G5tG893YkQEVVjr86DKGv0zA7FE86Ct9AVOv/fI2SW5emWsWGVYqXr9wOM+xUESx+1c25REVOxIVb8lTc01VZcT9s/tj8Z2rKm2xmPTHVkz6V0PGkPVV2Xf64XhaFaSjqcqK166ykO+zGqrFU9OF9aogHU1jeD2C8k4Hsk/Qo7BSLrpXX4fZD7InTbrrpZpH+d3pJWdhpSxxOLDzXNBp3Caou92Ck6Bpw0qeCzqN/I/CT6v1PgnqCyu5IyBB1fLWhpagScNKwQgqLTSlp4mJSBuThpU8F9TUQYfzLlArB/WEldzhuaDODEiHk6Bpw0q+C1LttxpptJcF1YImCytJfBeketJ5ohU0WVhJ4rugntiRgQmm+L0X9Dh2ZGCCRSLeC3oUOzJgCitdiv+ChkcIB4cebQhAUCd2ZMAYVrqYEAQtCgUBKAhAQQAKAlAQwE6Q2rPu61qeKbASlNUxmRzMT0WEjaDWAnl/V8a7xkZQsWmCLfnVFDLmIIBlHdTMrrAO6qXYJJ2jV64A9oMAFAS4UFDGVswule4GiZiypeN7oaBhyUVkyO5WxGkZVVdIVwdduSAxiSdXwVFQH3KoUW0noKA+6sFqutpRUB/NYDW9paBeai2tJV39yV2roGY4r11mcu2CBicXjyEKAlAQgIIAFASgIAAFASgIQEGAiQTFY4iCABQEoCAABQEoCDDNvJjLU9YWprmLYjNis975zOrDw0PyEJkgOek1dtlP1IKODhzFLkgqGrFyI3JBeTWzLA8aG5NcnILE8jppZsQS1ogFFRsXx1qdBD1E18yrI4nGrYC+AkHjFtdFKyg9dfUcNfORCXJ16ldLUGyVtMvkKAgkF5+gYnNX7zIYt1kuVkGOk6MgkFycgspiJoaqxnEY3LPaERSFodNNpKvdfn17TA1hM7xnNWJBYglrrg761DBgx2HkgsQX3xqGGgP2rEYsqCxb4rww03m7152DRDzo5t58IBbes9ptxWIwZHcPcM/qtQsamFycgpycy9Gtg2KYPmxV0jZmzHs1lCD536jLW55WMz8iUtYzsxqhIBenoEYsyOrES5BclILcfKn0maAIZsfaqztct2JxCRpA41Cv8boFDTiu+VxQ+AOy1vWXGWS1M383F6zJYxaU39xnYjRvNIRq8ogFiVhGZtgRb5NclIJER1EIcrZ44SGO0P2jHJSOOn4rYkGqDhr5vQsxC5LdnJGrqHoEBW5oyoAZBemSi1KQHEeMPSCxT1DYYcX60tW3B2Uj19r3CAo85qEuPa8r5/3adStW5qHwBbXGWKa5+aHJdQWFPaRvFlDVv3A81KgEhV8HOTspuldQ0C0ZBQFmERRDHTSxoHAN1YJgtNkmufgEjU5FM7N6EhSsoenHYrIOoqB2cn2CQjU0l6BgDc0kKNwx/UyCwm3KKAgwo6AwDc0rKEBDswoKsSmbV1CAhmYuYuGVslkFhVhTLyAoLENLCAqqoNldqd2WzH5BgeUiqyu13JKpFRSSIpvrtN1QZxYUSEGzWwZstyXTJCiYXLRUDgqmY2RZB1ltycSCmrLmrya7C7PbkjlEkFzd4LGl+ftBmuf6cXt1l+CNoPPMVMeyl+bCSxi4JdNakDlL1RNwl97sJUwzcRgA8wqKGAoCOB6sxofjwWp8OB5qqER94nI38l4sXjt4mZUpUZ+eG8I0OSiQ54bgeLCKE/XpuSE4HqziRH16bgiT9IN8kkBBI54bAgUBKAhAQQAOVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI4F5QbjzGav9cMx1SzUnqIt2Z+Wgs3blrMkI87hBf54LEOTK59m6KjWa+6LAt35NpbkasJdGnWf5JNIL2z8Z/Z5prQXJqSHeETK6dtZbH8vSvqqmOXtEfAlqdINr/cQ6myF0LMt2omC0yX7Mhm+gFZaufNIIyB0dkOxdU5Wq9BrMgw7n6mc5d+Ym6Oih9aajXBuJakMwD+pxgFKSfj8y1NyrKtEaQ+KaZ0pKLQ8fcMUZQbmpwdF+wDE8PHVkReVTEwHx2v/Tq84yCnJzK5g5jJX00CUIH8PXfaKYWuegljGzr523mDYIMh8hKNYa8p8lB8H1DmLmjqL3c/dqQf4SA1tqb3ud7fy/+Tp5V0mhYoBOkiormnamxEOnrIPC+IXCwCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvguSKxVa31F5fz4Lqj+lvfF8F3QMX/y1+vxGwoux3tBx3TkbpSR+C8oH7uIbhzeCzps3y96aqP3grLVP4b1rdPjuyBxNKGLXU0X47sguUR6wWrad0GLQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4HCM6rL+T9pyUAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="a-22036-2022-09-23" class="section level1">
<h1>A-22036-2022-09-23</h1>
<div id="quicksort" class="section level2">
<h2>Quicksort</h2>
<div id="question-5" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted, numbers of <span class="math inline">\(1, . . . ,
n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ol>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">&lt;-</span>y [y<span class="sc">&gt;=</span>a]</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> e<span class="sc">*</span><span class="fu">log</span>(e)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  sum_t <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">sample</span>(e[i])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    sum_t <span class="ot">&lt;-</span> sum_t <span class="sc">+</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#system.time(quick_sort(test))[1]</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> sum_t<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(a<span class="sc">~</span>t)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a ~ t)
## 
## Residuals:
##         1         2         3         4         5 
## -0.004818 -0.003432  0.009814  0.006680 -0.008245 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 1.273e-02  7.379e-03   1.725   0.1830   
## t           1.606e-07  1.357e-08  11.833   0.0013 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.009017 on 3 degrees of freedom
## Multiple R-squared:  0.979,  Adjusted R-squared:  0.972 
## F-statistic:   140 on 1 and 3 DF,  p-value: 0.001298</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##  (Intercept)            t 
## 1.273010e-02 1.605594e-07</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>t,<span class="at">y=</span>a,<span class="at">main =</span> <span class="st">&quot;time - nlogn&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,fit<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>y,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the graph there is a linear relationship between time and <span class="math inline">\(nlog(n)\)</span>. In fact it can be proved <span class="math inline">\(time = O(nlogn)\)</span>.</p>
</div>
</div>
<div id="section-4" class="section level2">
<h2>5.6 &amp; 5.7</h2>
<div id="question-6" class="section level3">
<h3>Question</h3>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">exp</span>(u) <span class="co"># x*u ~ N(0,x)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(MC1),<span class="fu">mean</span>(MC2))</span></code></pre></div>
<pre><code>## [1] 1.718060 1.718153</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#theta估计：MC方法 对偶方法</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(MC1)<span class="sc">^</span><span class="dv">2</span>,<span class="fu">sd</span>(MC2)<span class="sc">^</span><span class="dv">2</span>,<span class="fu">sd</span>(MC2)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sd</span>(MC1)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2.444883e-04 7.910555e-06 3.235556e-02</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MC方法 对偶方法 对偶方法方差/MC方法方差</span></span></code></pre></div>
<p>97% percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variate, compared with simple MC.</p>
<p><span class="math inline">\(Cov(e^{U},e^{1-U})=E(e^{U}e^{1-U})-E(e^{U})E(e^{1-U})=e-(e-1)^2\)</span>
<span class="math inline">\(Var(e^{U}+e^{1-U})=Var(e^{U})+Var(e^{1-U})+2Cov(e^{U},e^{1-U})=2[\frac{e^2-1}{2}-(e-1)^2]+2[e-(e-1)^2]=0.015\)</span></p>
<p><span class="math inline">\(Var(\hat{\theta_{antithetic}})=\frac{Var(e^{U}+e^{1-U})}{2m}=\frac{0.015}{2000}=
7.5e-06\)</span> <span class="math inline">\(Var(\hat{\theta_{MC}})
=\frac{Var(e^{U)}}{m}=\frac{0.242}{1000}=2.42e-04\)</span> $==0.03099174
$ Here the mathematical result agrees with experimental comparison.</p>
</div>
</div>
</div>
<div id="a-22036-2022-09-30" class="section level1">
<h1>A-22036-2022-09-30</h1>
<div id="section-5" class="section level2">
<h2>5.13</h2>
<div id="question1" class="section level3">
<h3>Question1</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[ g(x) = \frac{x^2}{\sqrt{2\pi}} e^{−x^2/2}, x
&gt; 1. \]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[ \int^{\infty}_1
\frac{x^2}{\sqrt{2\pi}} e^{−x^2/2} dx \]</span></p>
<p>by importance sampling? Explain.</p>
</div>
<div id="answer1" class="section level3">
<h3>Answer1</h3>
<p><span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{1}{2}x^2}\)</span>
Let <span class="math inline">\(f_1(x)=e^{1-x},
f_2(x)=\frac{1}{x^2}\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">3.1415926</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span><span class="sc">/</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return (1/sqrt(2*pi)*exp(-0.5*x^2))</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u) <span class="co"># Inverse transform algorithm</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u) <span class="co"># Inverse transform algorithm</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x1) <span class="sc">/</span> <span class="fu">f1</span>(x1)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x2) <span class="sc">/</span> <span class="fu">f2</span>(x2)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>theta1_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>theta2_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg2)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg2)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(theta[[<span class="dv">1</span>]], theta1_hat, theta2_hat) <span class="co">#(theta_true, theta_estimate_of_f1, theta_estimate_of_f2)</span></span></code></pre></div>
<pre><code>## [1] 0.4006260 0.4023681 0.4030237</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(sd1,sd2) <span class="co">#(stand error with f1, stand error with f2)</span></span></code></pre></div>
<pre><code>## [1] 0.1559490 0.3050777</code></pre>
<p>Estimate of method with <span class="math inline">\(f_1\)</span> and
<span class="math inline">\(f_1\)</span> are both correct. Variance of
the method with <span class="math inline">\(f_1\)</span> is smaller.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fl">0.1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">g</span>(x),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylab=</span><span class="st">&quot;prob&quot;</span>,<span class="at">main=</span><span class="st">&quot;y-x&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f1</span>(x),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f2</span>(x),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot it can be seen in most areas, <span class="math inline">\(f_1(x)\)</span> is closer to have a shape of <span class="math inline">\(cg(x)\)</span> than <span class="math inline">\(f_2(x)\)</span>, therefore its variance is
smaller.</p>
</div>
</div>
<div id="section-6" class="section level2">
<h2>5.15</h2>
<div id="question2" class="section level3">
<h3>Question2</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<p>There is something wrong with the subintervals in Exercise 5.15
(Example 5.13). You may modify it without losing the original
intent.</p>
</div>
<div id="answer2" class="section level3">
<h3>Answer2</h3>
<p>In stratified importance sampling method, let $f(x)=k(i)f_3(x) $ as
modification, here $f_3(x) <span class="math inline">\(is same as in
Example 5.10 . In fact, in order to satisfy\)</span>^{}_{}
f(x)dx=E[]<span class="math inline">\(, f(x) should be a pdf on
interval\)</span>[a,b]=[,]$, thus on each [a,b] stratified, <span class="math inline">\(f(x)=\frac{e^{-x}}{e^{-a}-e^{-b}},x\in
[a,b]\)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>theta_s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>var_s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>ab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">3</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">4</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  k[i] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>ab[i]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>ab[i<span class="sc">+</span><span class="dv">1</span>]))</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>ab[i]) <span class="sc">-</span> u <span class="sc">*</span> (<span class="fu">exp</span>(<span class="sc">-</span>ab[i]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>ab[i<span class="sc">+</span><span class="dv">1</span>])))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    tmpfg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>ab[i]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>ab[i<span class="sc">+</span><span class="dv">1</span>])) )</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    theta_s[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmpfg)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#var_s[i] &lt;- sd(tmpfg)^2</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  theta[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(theta_s) </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(theta)</span></code></pre></div>
<pre><code>## [1] 0.524814</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(theta)</span></code></pre></div>
<pre><code>## [1] 7.196569e-09</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">0.5257801</span>,<span class="fl">0.0970314</span><span class="sc">^</span><span class="dv">2</span>) <span class="co">#Estimate and variance from Example 5.13.</span></span></code></pre></div>
<pre><code>## [1] 0.525780100 0.009415093</code></pre>
<p>It is clear that <span class="math inline">\(Var(\hat\theta^{SI})
&lt; Var(\hat\theta^I)\)</span>.</p>
</div>
</div>
</div>
<div id="a-22036-2022-10-09" class="section level1">
<h1>A-22036-2022-10-09</h1>
<div id="section-7" class="section level2">
<h2>6.4</h2>
<div id="question-7" class="section level3">
<h3>QUESTION</h3>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a
random sample from a from a lognormal distribution with unknown
parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
</div>
<div id="answer-7" class="section level3">
<h3>ANSWER</h3>
<div id="stats-analysis" class="section level4">
<h4>stats analysis</h4>
<p>X is from a log-normal distribution. Let <span class="math inline">\(Y=Log(X) \sim N(\mu,\sigma^2)\)</span>. 95% CI of
Y is <span class="math inline">\([L,R]=[\hat\beta-\frac{1}{\sqrt{n}}t_{n-1}(0.975)\hat\sigma,\hat\beta+\frac{1}{\sqrt{n}}t_{n-1}(0.975)\hat\sigma]\)</span>.Here
<span class="math inline">\(\hat\beta=mean(Y),\hat\sigma=sd(Y)\)</span>
So 95% CI of X is <span class="math inline">\([e^L,e^R]\)</span>.</p>
</div>
<div id="data-generating" class="section level4">
<h4>data generating</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mcci <span class="ot">&lt;-</span> <span class="cf">function</span>(m,n,miu, se){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    Lx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,miu,se)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    lower[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Lx) <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(Lx)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    upper[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Lx) <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(Lx)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(lower))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(upper))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(Lx) <span class="co">#clearing</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(upper)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(lower)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">c</span>(L, R))</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-report" class="section level4">
<h4>result report</h4>
<p>Example:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcci</span>(<span class="dv">1000</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.6285733 1.5858913</code></pre>
</div>
</div>
</div>
<div id="section-8" class="section level2">
<h2>6.8</h2>
<div id="question-8" class="section level3">
<h3>QUESTION</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat\alpha = 0.055\)</span>. Compare the power of
the Count Five test and F test for small, medium, and large sample
sizes. (Recall that the F test is not applicable for non-normal
distributions.)</p>
</div>
<div id="answer-8" class="section level3">
<h3>ANSWER</h3>
<div id="data-generating-1" class="section level4">
<h4>data generating</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(X)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Y)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>Ftest <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">as.integer</span>(<span class="fu">var.test</span>(x,y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level =</span> <span class="fl">0.945</span>)[[<span class="dv">3</span>]]<span class="sc">&lt;</span><span class="fl">0.055</span>))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="data-analysis" class="section level4">
<h4>data analysis</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>comparision <span class="ot">&lt;-</span> <span class="cf">function</span>(m,n){</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  num1 <span class="ot">=</span> num2 <span class="ot">=</span><span class="dv">0</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    num1 <span class="ot">=</span> num1 <span class="sc">+</span> <span class="fu">count5test</span>(x, y)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    num2 <span class="ot">=</span> num2 <span class="sc">+</span> <span class="fu">Ftest</span>(x, y)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>power1 <span class="ot">&lt;-</span> num1<span class="sc">/</span>m</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>power2 <span class="ot">&lt;-</span> num2<span class="sc">/</span>m</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x) <span class="co">#clear memory</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(y) <span class="co">#clear memory</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (<span class="fu">c</span>(power1,power2))</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-report-1" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;CountFive Test, F Test&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;CountFive Test, F Test&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">comparision</span>(<span class="dv">1000</span>,<span class="dv">20</span>) <span class="co">#small sample size</span></span></code></pre></div>
<pre><code>## [1] 0.333 0.445</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">comparision</span>(<span class="dv">1000</span>,<span class="dv">200</span>) <span class="co">#medium sample size</span></span></code></pre></div>
<pre><code>## [1] 0.939 1.000</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">comparision</span>(<span class="dv">1000</span>,<span class="dv">2000</span>) <span class="co">#large sample size</span></span></code></pre></div>
<pre><code>## [1] 0.999 1.000</code></pre>
<p>When sample size is small, sample is not near normal distribution, so
power of test is small. As sample size grows larger, power becomes
larger too, approaching 1. Because CountFive test is a simple
non-parametric test, its power is apparently lower than power of F test,
for we operate test under normal distribution sample.</p>
</div>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<div id="question1-1" class="section level3">
<h3>QUESTION1</h3>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
</div>
<div id="answer1-1" class="section level3">
<h3>ANSWER1</h3>
<p>See the analysis below. It depends on certain hypothesis test.</p>
</div>
<div id="question2-1" class="section level3">
<h3>QUESTION2</h3>
<p>What is the corresponding hypothesis test problem?</p>
</div>
<div id="answer2-1" class="section level3">
<h3>ANSWER2</h3>
<p>Let <span class="math inline">\(Power_1=\)</span> power of first
test, with estimate = 0.651, <span class="math inline">\(Power_2=\)</span> power of first test, with
estimate = 0.676, <span class="math inline">\(H_0:Power_1=Power_2,H1:Power1\neq
Power2\)</span>.</p>
</div>
<div id="question3" class="section level3">
<h3>QUESTION3</h3>
<p>Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
</div>
<div id="answer3" class="section level3">
<h3>ANSWER3</h3>
<p>McNemar test. McNemar is a non-parametric method for 10000 paired
data, which is a 0-1 contingency table corresponding test (its content
is a binomial distribution), while other three tests demand normal
distribution, which is not suitable here. The problem can be written as
a contingency table test, according to definition of power:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;n11&quot;</span>,<span class="st">&quot;n21&quot;</span>,<span class="st">&quot;n12&quot;</span>,<span class="st">&quot;n22&quot;</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(t) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;reject under H1&quot;</span>, <span class="st">&quot;accept under H1&quot;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(t) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;reject under H1&quot;</span>, <span class="st">&quot;accept under H1&quot;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
<pre><code>##                 reject under H1 accept under H1
## reject under H1 &quot;n11&quot;           &quot;n12&quot;          
## accept under H1 &quot;n21&quot;           &quot;n22&quot;</code></pre>
<p>Here row means test1 and column means test2.</p>
<p>Therefore:<span class="math inline">\(H_0:n_{11}+n_{12}=n_{21}+n_{22}\)</span>. The
statistic of test is <span class="math inline">\(X =
\frac{(n_{12}-n_{21})^2}{n_{12}+n_{21}}\)</span> , and it is a
Chi-Squared Distribution with <span class="math inline">\(df=1\)</span>
under <span class="math inline">\(H_0\)</span>.</p>
</div>
<div id="question4" class="section level3">
<h3>QUESTION4</h3>
<p>Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer4" class="section level3">
<h3>ANSWER4</h3>
<p>From the problem description, we do not know the exact condition of
each pair sample, but only know the total numbers. So we cannot provide
the contingency table. Thus we cannot say the powers are different at
0.05 level. (Back to question1)</p>
</div>
</div>
</div>
<div id="a-22036-2022-10-14" class="section level1">
<h1>A-22036-2022-10-14</h1>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<div id="section-9" class="section level2">
<h2>7.4</h2>
<p>Refer to the air-conditioning data set aircondition provided in the
boot package. The 12 observations are the times in hours between
failures of air-conditioning equipment [63, Example 1.1]: 3, 5, 7, 18,
43, 85, 91, 98, 100, 130, 230, 487. Assume that the times between
failures follow an exponential model <span class="math inline">\(Exp(\lambda)\)</span>. Obtain the MLE of the
hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
<div id="answer-9" class="section level3">
<h3>ANSWER</h3>
<div id="stats-analysis-1" class="section level4">
<h4>stats analysis</h4>
<p>Assume <span class="math inline">\(X_1,X_2,...,X_n\)</span> from
<span class="math inline">\(Exp(\lambda)\)</span>. Its pdf is <span class="math inline">\(f(x,\lambda)=\lambda e^{-\lambda x}\)</span>.
Likelihood <span class="math inline">\(L(\lambda;x_1,...,x_n)=\lambda ^n
e^{-n \overline{x} \lambda}\)</span>. <span class="math inline">\(\frac{\partial
L}{\partial{\lambda}}=n\lambda^{n-1}e^{-n \overline{x} \lambda}-n
\overline{x} \lambda^{n-1}e^{-n \overline{x}}\)</span>. Let it = 0, here
we can get MLE of <span class="math inline">\(\lambda\)</span> that
<span class="math inline">\(\hat\lambda =
\frac{1}{\overline{X}}\)</span>.</p>
</div>
<div id="data-generating-2" class="section level4">
<h4>data generating</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  thetastar[b] <span class="ot">&lt;-</span> <span class="fu">mean</span>(xstar)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-report-2" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">thetahat=</span> <span class="fu">mean</span>(thetastar), <span class="at">theta=</span> theta)</span></code></pre></div>
<pre><code>## thetahat    theta 
## 107.6954 108.0833</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta, <span class="at">se.boot=</span><span class="fu">sd</span>(thetastar), <span class="at">se.samp=</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x)))</span></code></pre></div>
<pre><code>##       bias    se.boot    se.samp 
## -0.3879167 37.5637674 39.3268083</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(thetastar)</span></code></pre></div>
</div>
</div>
</div>
<div id="section-10" class="section level2">
<h2>7.5</h2>
<div id="question-9" class="section level3">
<h3>QUESTION</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal,
basic, percentile, and BCa methods. Compare the intervals and explain
why they may differ.</p>
</div>
<div id="answer-10" class="section level3">
<h3>ANSWER</h3>
<div id="stats-analysis-2" class="section level4">
<h4>stats analysis</h4>
<p><span class="math inline">\(\hat {\frac{1}{\lambda}}= \overline
X\)</span>.</p>
</div>
<div id="data-generating-3" class="section level4">
<h4>data generating</h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e1</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>boot.median <span class="ot">&lt;-</span> <span class="cf">function</span>(t,i){</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">median</span>(t[i]))</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(t,i){</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">mean</span>(t[i]))</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> ci.bca <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.median, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>), <span class="at">conf=</span><span class="fl">0.95</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, conf = 0.95, type = c(&quot;norm&quot;, &quot;basic&quot;, 
##     &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 39.74, 158.19 )   ( 61.00, 163.50 )  
## 
## Level     Percentile            BCa          
## 95%   ( 12.50, 115.00 )   (  7.00, 112.56 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="result-report-analysis" class="section level4">
<h4>result report &amp; analysis</h4>
<p>In fact <span class="math inline">\(\overline X\)</span> is with a
distribution of <span class="math inline">\(Gamma(n,n \lambda)\)</span>.
A rough representation of distribution of <span class="math inline">\(\overline X\)</span> is here:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>,<span class="at">shape =</span> <span class="dv">12</span>, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span><span class="sc">*</span><span class="dv">108</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(tmp)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tmp)</span></code></pre></div>
<p>Here we can see there is a difference between it and normal
distribution. So bootstrap-normal is not so effective in this sample,
and its confidence interval is not accurate. Bootstrap-basic assumes
symmetry on left and right, but <span class="math inline">\(Gamma\)</span> distribution is not symmetric. In
fact, <span class="math inline">\(Gamma\)</span> concentrates on the
left (near zero), which is the reason that both CI of bootstrap-normal
and bootstrap-basic are much bigger than others. Bootstrap-percentile
and bootstrap-bca is close to the empirical distribution of <span class="math inline">\(\overline X\)</span>, and their confidence
interval are closer than others.</p>
</div>
</div>
</div>
<div id="project-a" class="section level2">
<h2>Project A</h2>
<div id="question-10" class="section level3">
<h3>QUESTION</h3>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the proportion of times that the confidence
intervals miss on the right.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>bootci_mc <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">10000</span>){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  prob.c <span class="ot">&lt;-</span> prob.l <span class="ot">&lt;-</span> prob.r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> s, <span class="at">statistic =</span> boot.median, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(<span class="at">boot.out =</span> de, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    ci.norm[i, ] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i, ] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.perc[i, ] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ms &lt;- mean(s)</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(ms)</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.norm[, 1] &lt;= ms &amp; ci.norm[, 2] &gt;= ms) prob.c[1] &lt;- prob.c[1] +1</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.basic[, 1] &lt;= ms &amp; ci.basic[, 2] &gt;= ms) prob.c[2] &lt;- prob.c[2] +1</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.perc[, 1] &lt;= ms &amp; ci.perc[, 2] &gt;= ms) prob.c[3] &lt;- prob.c[3] +1</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.norm[, 2] &lt;= ms) prob.l[1] &lt;- prob.l[1] +1</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.basic[, 2] &lt;= ms) prob.l[2] &lt;- prob.l[2] +1</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.perc[, 2] &lt;= ms) prob.l[3] &lt;- prob.l[3] +1</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.norm[, 1] &gt;= ms) prob.r[1] &lt;- prob.r[1] +1</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.basic[, 1] &gt;= ms) prob.r[2] &lt;- prob.r[2] +1</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (ci.perc[, 1] &gt;= ms) prob.r[3] &lt;- prob.r[3] +1</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(s)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(de)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.norm[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="fu">mean</span>(ci.norm[, <span class="dv">2</span>] <span class="sc">&lt;=</span> mu), <span class="fu">mean</span>(ci.norm[, <span class="dv">1</span>] <span class="sc">&gt;=</span> mu)), </span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.basic[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="fu">mean</span>(ci.basic[, <span class="dv">2</span>] <span class="sc">&lt;=</span> mu), <span class="fu">mean</span>(ci.basic[, <span class="dv">1</span>] <span class="sc">&gt;=</span> mu)),</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.perc[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="fu">mean</span>(ci.perc[, <span class="dv">2</span>] <span class="sc">&lt;=</span> mu), <span class="fu">mean</span>(ci.perc[, <span class="dv">1</span>] <span class="sc">&gt;=</span> mu))))</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return (c(prob.c, prob.l, prob.r))</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="result-report-3" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">bootci_mc</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">m =</span> <span class="dv">1000</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ci) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coverage.prob&quot;</span>, <span class="st">&quot;missed.left&quot;</span>, <span class="st">&quot;missed.right&quot;</span>)</span></code></pre></div>
<p>The table below shows the empirical coverage rates for the sample
mean, and the proportion of times that the confidence intervals miss on
the left/right.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>##        coverage.prob missed.left missed.right
## normal         0.925       0.037        0.038
## basic          0.877       0.062        0.061
## perc           0.950       0.028        0.022</code></pre>
<p>Compared with mean, (not sample mean, because there will be full
coverage than), bootstrap-percentile covers best.</p>
</div>
</div>
</div>
</div>
<div id="a-22036-2022-10-21" class="section level1">
<h1>A-22036-2022-10-21</h1>
<div id="section-11" class="section level2">
<h2>7.8</h2>
<div id="question-11" class="section level3">
<h3>QUESTION</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span></p>
</div>
<div id="answer-11" class="section level3">
<h3>ANSWER</h3>
<div id="data-generating-4" class="section level4">
<h4>data generating</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> bootstrap<span class="sc">::</span>scor</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(data)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma_hat)<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">eigen</span>(sigma_hat)<span class="sc">$</span>values)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  tmp_scor <span class="ot">&lt;-</span> <span class="fu">cov</span>(data[<span class="sc">-</span>i,])</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">eigen</span>(tmp_scor)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  theta_jack[i] <span class="ot">&lt;-</span> e<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(e<span class="sc">$</span>values)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tmp_scor)</span></code></pre></div>
</div>
<div id="result-report-4" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sigma_hat</span></code></pre></div>
<pre><code>##          mec       vec       alg       ana       sta
## mec 305.7680 127.22257 101.57941 106.27273 117.40491
## vec 127.2226 172.84222  85.15726  94.67294  99.01202
## alg 101.5794  85.15726 112.88597 112.11338 121.87056
## ana 106.2727  94.67294 112.11338 220.38036 155.53553
## sta 117.4049  99.01202 121.87056 155.53553 297.75536</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>theta_hat</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>se_theta <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jack <span class="sc">-</span> <span class="fu">mean</span>(theta_jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(bias,se_theta)</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
</div>
</div>
<div id="section-12" class="section level2">
<h2>7.11</h2>
<div id="question-12" class="section level3">
<h3>QUESTION</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
<div id="answer-12" class="section level3">
<h3>ANSWER</h3>
<div id="data-generating-5" class="section level4">
<h4>data generating</h4>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#if (k==j) break</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k,j)]</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k,j)]</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    yhat1k <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    yhat1j <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j]</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    e1[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat1k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[j] <span class="sc">-</span> yhat1j)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x<span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    yhat2k <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    yhat2j <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[j]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    e2[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat2k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[j] <span class="sc">-</span> yhat2j)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    yhat3k <span class="ot">&lt;-</span> <span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k])</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    yhat3j <span class="ot">&lt;-</span> <span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j])</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    e3[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat3k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[j] <span class="sc">-</span> yhat3j)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>    yhat4k <span class="ot">&lt;-</span> <span class="fu">exp</span>(J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k]))</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>    yhat4j <span class="ot">&lt;-</span> <span class="fu">exp</span>(J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[j]))</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>    e4[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat4k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[j] <span class="sc">-</span> yhat4j)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-report-5" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.55727 17.85409 18.43866 20.45229</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(e1,e2,e3,e4,yhat1j,yhat1k,yhat2k,yhat2j,yhat3k,yhat3j,yhat4k,yhat4j)</span></code></pre></div>
<p>Here model 2 is the best, with the least prediction error.</p>
</div>
</div>
</div>
<div id="section-13" class="section level2">
<h2>8.2</h2>
<div id="question-13" class="section level3">
<h3>QUESTION</h3>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function cor with method = “spearman”.
Compare the achieved significance level of the permutation test with the
p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-13" class="section level3">
<h3>ANSWER</h3>
<div id="data-generating-6" class="section level4">
<h4>data generating</h4>
<p>Generate two groups of data : x,y .</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>)),<span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>)))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>cor_hat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>p_cor.test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)[[<span class="dv">3</span>]]</span></code></pre></div>
</div>
<div id="data-analysis-1" class="section level4">
<h4>data analysis</h4>
<p>Compute p-value through permutation test.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>cor_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(x,y))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  cor_t[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(z[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],z[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>p_permutation <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(cor_t)<span class="sc">&gt;=</span><span class="fu">abs</span>(cor_hat))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p_permutation, p_cor.test)</span></code></pre></div>
<pre><code>## [1] 0.02650000 0.02751412</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x,y,cor_t)</span></code></pre></div>
<p>P-value from permutation method is close to p-value from cor.test
function.</p>
</div>
</div>
</div>
</div>
<div id="a-22036-2022-10-28" class="section level1">
<h1>A-22036-2022-10-28</h1>
<div id="section-14" class="section level2">
<h2>9.4</h2>
<div id="question-14" class="section level3">
<h3>QUESTION</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
</div>
<div id="answer-14" class="section level3">
<h3>ANSWER</h3>
<div id="mcmc-gennerating-using-random-walk-metropolis" class="section level4">
<h4>MCMC gennerating using random walk metropolis</h4>
<p><span class="math inline">\(\alpha(x_t,
y)=min(1,\frac{f(y)}{f(x_t)})=min(1,e^{-\lvert{y}\rvert+
\lvert{x}\rvert})\)</span></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y)<span class="sc">+</span><span class="fu">abs</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]; k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>(n))</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (r.hat)</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-report-6" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>reject_rate <span class="ot">&lt;-</span> <span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k ,rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)<span class="sc">/</span>N</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>reject_rate</span></code></pre></div>
<pre><code>## [1] 0.0165 0.1730 0.3120 0.7230</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rw1<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw1<span class="sc">$</span>x))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rw2<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw2<span class="sc">$</span>x))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rw3<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;sigma=1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw3<span class="sc">$</span>x))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rw4<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;sigma=5&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw4<span class="sc">$</span>x))</span></code></pre></div>
<p>When sigma is too small, mc list cannot converge in first 2000 turns.
As variance increases, reject rate increases as well, that is, speed of
convergence grows. However, when sigma is too big, the list may not be
more effective.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>GR.converge <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">5000</span>){</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  n.converge <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(k, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>      psi <span class="ot">&lt;-</span> <span class="fu">rbind</span>(psi, <span class="fu">rw.Metropolis</span>(sigma, x0[j],  m)<span class="sc">$</span>x)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>      GR <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(<span class="fu">as.matrix</span>(psi)[, <span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(GR <span class="sc">&lt;</span> <span class="fl">1.2</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (n)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="use-gelman-rubin-to-compute-iteration-until-convergence." class="section level4">
<h4>use Gelman Rubin to compute iteration until convergence.</h4>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;sigma=0.5:&quot;</span>,<span class="fu">GR.converge</span>(sigma[<span class="dv">2</span>]),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## sigma=0.5: 608</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;sigma=1:&quot;</span>,<span class="fu">GR.converge</span>(sigma[<span class="dv">3</span>]),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## sigma=1: 58</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;sigma=5:&quot;</span>,<span class="fu">GR.converge</span>(sigma[<span class="dv">4</span>]),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## sigma=5: 49</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(rw1,rw2,rw3,rw4)</span></code></pre></div>
</div>
</div>
</div>
<div id="section-15" class="section level2">
<h2>9.7</h2>
<div id="question-15" class="section level3">
<h3>QUESTION</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = β_0 + β_1X\)</span> to the sample
and check the residuals of the model for normality and constant
variance.</p>
</div>
<div id="answer-15" class="section level3">
<h3>ANSWER</h3>
<div id="mcmc-generating" class="section level4">
<h4>mcmc generating</h4>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(x01, x02, <span class="at">N =</span> <span class="dv">5000</span>){</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co"># the chain, a bivariate sample</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x01, x02) </span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (X)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-report-7" class="section level4">
<h4>result report</h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(<span class="dv">0</span>,<span class="dv">0</span>)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x[1]&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">1</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">2</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x[2]&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(x)</span></code></pre></div>
<pre><code>## [1] -0.1144960 -0.1112776</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.9698688 0.8611772
## [2,] 0.8611772 0.9560940</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.8943052
## [2,] 0.8943052 1.0000000</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">bquote</span>(X[<span class="dv">1</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="lm-test" class="section level4">
<h4>lm test</h4>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(x[,<span class="dv">2</span>]<span class="sc">~</span>x[,<span class="dv">1</span>])</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.50122 -0.29313  0.00604  0.28450  1.43153 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.009613   0.013936   -0.69     0.49    
## x[, 1]       0.887932   0.014063   63.14   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4377 on 998 degrees of freedom
## Multiple R-squared:  0.7998, Adjusted R-squared:  0.7996 
## F-statistic:  3987 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Using F.test to check residuals, from the p-value &lt; 2.2e-16 result
above, residuals agree with normal model, that is, lm model is
correct.</p>
</div>
<div id="gelman-rubin-monotoring" class="section level4">
<h4>Gelman Rubin monotoring</h4>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>GR.biconverge <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">m =</span> <span class="dv">5000</span>){</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(k, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  psi1 <span class="ot">&lt;-</span> psi2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k<span class="sc">/</span><span class="dv">2</span>){</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    xk <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(x0[j], x0[j<span class="sc">+</span><span class="dv">10</span>],  m)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    psi1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(psi1, xk[,<span class="dv">1</span>])</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    psi2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(psi2, xk[,<span class="dv">2</span>])</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">10</span><span class="sc">:</span>m){</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    GR1 <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(<span class="fu">as.matrix</span>(psi1)[, <span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>    GR2 <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(<span class="fu">as.matrix</span>(psi2)[, <span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(c(GR1,GR2))</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(GR1 <span class="sc">&lt;</span> <span class="fl">1.2</span> <span class="sc">&amp;</span> GR2<span class="sc">&lt;</span> <span class="fl">1.2</span>)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (n)</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>When the mc chain converges through gr monitoring:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GR.biconverge</span>()</span></code></pre></div>
<pre><code>## [1] 27</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="a-22036-2022-11-04" class="section level1">
<h1>A-22036-2022-11-04</h1>
<div id="question-16" class="section level2">
<h2>QUESTION</h2>
</div>
<div id="answer1-2" class="section level2">
<h2>ANSWER1</h2>
<div id="data-generating-7" class="section level3">
<h3>data generating</h3>
<p>Key: Permutate X in first hypothesis, permutate Y in second
hypothesis, permutate M in third hypothesis.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>generating <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, beta, gamma, N){</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  eM <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  eY <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> alpha<span class="sc">*</span>x <span class="sc">+</span> eM</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> beta<span class="sc">*</span>m <span class="sc">+</span> gamma<span class="sc">*</span>x <span class="sc">+</span> eY</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(x, m, y))</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>t_comp <span class="ot">&lt;-</span> <span class="cf">function</span>(x, m, y){</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, m, y)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  Model_M <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span>x, data)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  Model_Y <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x, data)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  t_stat <span class="ot">&lt;-</span> Model_M<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>Model_Y<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sqrt</span>(Model_M<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">summary</span>(Model_M)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>Model_Y<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">summary</span>(Model_Y)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.numeric</span>(t_stat))</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>permutation_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">N =</span> <span class="dv">20</span>, <span class="at">B =</span> <span class="dv">99</span>){</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> data[k, <span class="dv">1</span>] </span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">&lt;-</span> <span class="fu">t_comp</span>(x, data<span class="sc">$</span>m, data<span class="sc">$</span>y)</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(reps) <span class="sc">&gt;</span> <span class="fu">abs</span>(<span class="fu">t_comp</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>m, data<span class="sc">$</span>y)))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>B)</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (p)</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>permutation_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">N =</span> <span class="dv">20</span>, <span class="at">B =</span> <span class="dv">99</span>){</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> data[k, <span class="dv">3</span>]</span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">&lt;-</span> <span class="fu">t_comp</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>m, y)</span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(reps) <span class="sc">&gt;</span> <span class="fu">abs</span>(<span class="fu">t_comp</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>m, data<span class="sc">$</span>y)))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>B)</span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (p)</span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>permutation_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">N =</span> <span class="dv">20</span>, <span class="at">B =</span> <span class="dv">99</span>){</span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> data[k, <span class="dv">2</span>]</span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">&lt;-</span> <span class="fu">t_comp</span>(data<span class="sc">$</span>x, m, data<span class="sc">$</span>y)</span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(reps)<span class="sc">&gt;</span><span class="fu">abs</span>(<span class="fu">t_comp</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>m, data<span class="sc">$</span>y)))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>B)</span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (p)</span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="report" class="section level3">
<h3>report</h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, beta, <span class="at">gamma=</span><span class="dv">1</span>, <span class="at">N=</span><span class="dv">20</span>){</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> K)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">generating</span>(alpha, beta, gamma, N)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    p[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> <span class="fu">permutation_1</span>(data)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    p[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> <span class="fu">permutation_2</span>(data)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    p[<span class="dv">3</span>,i] <span class="ot">&lt;-</span> <span class="fu">permutation_3</span>(data)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p[<span class="dv">1</span>,]<span class="sc">&lt;=</span><span class="fl">0.05</span>),<span class="fu">mean</span>(p[<span class="dv">2</span>,]<span class="sc">&lt;=</span><span class="fl">0.05</span>),<span class="fu">mean</span>(p[<span class="dv">3</span>,]<span class="sc">&lt;=</span><span class="fl">0.05</span>)))</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>simulation1 <span class="ot">&lt;-</span> <span class="fu">func</span>(<span class="at">alpha=</span><span class="dv">0</span>, <span class="at">beta=</span><span class="dv">0</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>simulation2 <span class="ot">&lt;-</span> <span class="fu">func</span>(<span class="at">alpha=</span><span class="dv">0</span>, <span class="at">beta=</span><span class="dv">1</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>simulation3 <span class="ot">&lt;-</span> <span class="fu">func</span>(<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">beta=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>Permutation_Test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model1=</span>simulation1, <span class="at">Model2=</span>simulation2, <span class="at">Model3=</span>simulation3)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(Permutation_Test) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Permutation_Test_1&quot;</span>, <span class="st">&quot;Permutation_Test_2&quot;</span>, <span class="st">&quot;Permutation_Test_3&quot;</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>Permutation_Test</span></code></pre></div>
<pre><code>##                    Model1 Model2 Model3
## Permutation_Test_1   0.11   0.22   0.17
## Permutation_Test_2   0.33   1.00   0.02
## Permutation_Test_3   0.05   0.35   0.34</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Type 1 error table</span></span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Permutation_Test)</span></code></pre></div>
</div>
</div>
<div id="answer2-2" class="section level2">
<h2>ANSWER2</h2>
<div id="data-generating-8" class="section level3">
<h3>data generating</h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">#N &lt;- 1e6; b1 &lt;- 1; b2 &lt;- 0.5; f0 &lt;- 0.01</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>work <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N=</span><span class="fl">1e6</span>, <span class="at">b1=</span><span class="dv">1</span>, <span class="at">b2=</span><span class="fl">0.5</span>, <span class="at">b3=</span><span class="dv">1</span>, <span class="at">f0=</span><span class="fl">0.01</span>){</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>); x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>); x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (<span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="report-1" class="section level3">
<h3>report</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">work</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##     root   f.root     iter 
## -3.16674  0.00000 10.00000</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">work</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>##     root   f.root     iter 
## -6.06819  0.00000 10.00000</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">work</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>##     root   f.root     iter 
## -8.71014  0.00000 11.00000</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">work</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.0001</span>)</span></code></pre></div>
<pre><code>##      root    f.root      iter 
## -11.29142   0.00000  11.00000</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>f00 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> f00</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f00))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">work</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,f00[i])</span></code></pre></div>
<pre><code>## Warning in x[i] &lt;- work(1e+06, 0, 1, -1, f00[i]): number of items to replace is
## not a multiple of replacement length

## Warning in x[i] &lt;- work(1e+06, 0, 1, -1, f00[i]): number of items to replace is
## not a multiple of replacement length

## Warning in x[i] &lt;- work(1e+06, 0, 1, -1, f00[i]): number of items to replace is
## not a multiple of replacement length

## Warning in x[i] &lt;- work(1e+06, 0, 1, -1, f00[i]): number of items to replace is
## not a multiple of replacement length</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>f00,<span class="at">x=</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x,f00)</span></code></pre></div>
</div>
</div>
</div>
<div id="a-22036-2022-11-11" class="section level1">
<h1>A-22036-2022-11-11</h1>
<div id="answer-1-1" class="section level3">
<h3>Answer 1</h3>
<div id="likelihood-mle" class="section level4">
<h4>likelihood MLE</h4>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(u)</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="cf">function</span>(lam){</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(u) <span class="sc">+</span> <span class="fu">sum</span>( (v<span class="sc">-</span>u) <span class="sc">/</span> ( <span class="fu">exp</span>(lam<span class="sc">*</span>(v<span class="sc">-</span>u))<span class="sc">-</span><span class="dv">1</span> ))</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (t)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">uniroot</span>(L1,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## $root
## [1] 0.07200052</code></pre>
</div>
<div id="em-algorithm" class="section level4">
<h4>EM algorithm</h4>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-5</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>lambda_1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="dv">1</span>){</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  lambda_1 <span class="ot">&lt;-</span> lambda_1 <span class="sc">-</span> <span class="fu">L1</span>(lambda)<span class="sc">/</span>n </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(<span class="dv">1</span><span class="sc">/</span>lambda_1 <span class="sc">-</span> lambda) <span class="sc">&lt;</span> eps) <span class="cf">break</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>lambda_1</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">iter =</span> iter, <span class="at">lambda =</span> lambda)</span></code></pre></div>
<pre><code>##       iter     lambda 
## 2.00000000 0.07197274</code></pre>
<p>From the result we can see both estimates are 0.072, through simple
MLE and EM iteration, which shows EM estimate equals to MLE.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(u,v)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(lambda,lambda_1)</span></code></pre></div>
</div>
</div>
<div id="section-16" class="section level3">
<h3>2.1.3</h3>
<div id="section-17" class="section level4">
<h4>4.</h4>
<div id="question-17" class="section level5">
<h5>Question</h5>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
</div>
<div id="answer-16" class="section level5">
<h5>Answer</h5>
<p>Elements in a vector have same type, while lists do not demand this.
So “as.vector” will convert a vector with elements of same type, while
“unlist” not.</p>
</div>
</div>
<div id="section-18" class="section level4">
<h4>5.</h4>
<div id="question-18" class="section level5">
<h5>Question</h5>
<p>Why is 1 == “1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2
false? ##### Answer In 1 == “1”, a integer vector is coerced to an
character, so the result is true. In -1 &lt; FALSE , logical atomic
vector FALSE is coerced to integer 0, so the result is true. In “one”
&lt; 2 , the character atomic vector “one” cannot be coerced to integer,
so it is false.</p>
</div>
</div>
</div>
<div id="section-19" class="section level3">
<h3>2.3.1</h3>
<div id="section-20" class="section level4">
<h4>1.</h4>
<div id="question-19" class="section level5">
<h5>Question</h5>
<p>What does dim() return when applied to a vector?</p>
</div>
<div id="answer-17" class="section level5">
<h5>Answer</h5>
<p>NULL. “dim” is for matrix, array, or data frame.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
</div>
<div id="section-21" class="section level4">
<h4>2.</h4>
<div id="question-20" class="section level5">
<h5>Question</h5>
<p>If is.matrix(x) is TRUE, what will is.array(x) return? ##### Answer
TRUE. A matrix is a special array.</p>
</div>
</div>
</div>
<div id="section-22" class="section level3">
<h3>2.4.5</h3>
<div id="section-23" class="section level4">
<h4>1.</h4>
<div id="question-21" class="section level5">
<h5>Question</h5>
<p>What attributes does a data frame possess? ##### Answer Names, row
names, class and groups(not all the time).</p>
</div>
</div>
<div id="section-24" class="section level4">
<h4>2.</h4>
<div id="question-22" class="section level5">
<h5>Question</h5>
<p>What does as.matrix() do when applied to a data frame with columns of
different types? ##### Answer Its elements will be coerced into a same
type, following the rule: logical &lt; integer &lt; double &lt;
character .</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
<pre><code>##                 reject under H1 accept under H1
## reject under H1 &quot;n11&quot;           &quot;n12&quot;          
## accept under H1 &quot;n21&quot;           &quot;n22&quot;</code></pre>
</div>
</div>
<div id="section-25" class="section level4">
<h4>3.</h4>
<div id="question-23" class="section level5">
<h5>Question</h5>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
</div>
<div id="answer-18" class="section level5">
<h5>Answer</h5>
<p>There exist data frames in R with 0 rows, but no data frames with 0
columns (when it has only one column, it turns back to a vector).</p>
</div>
</div>
</div>
</div>
<div id="a-22036-2022-11-18" class="section level1">
<h1>A-22036-2022-11-18</h1>
<div id="question1-2" class="section level3">
<h3>Question1</h3>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
</div>
<div id="answer1-3" class="section level3">
<h3>Answer1</h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>data1</span></code></pre></div>
<pre><code>##   x y
## 1 1 4
## 2 2 5
## 3 3 6</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(data1, scale01)</span></code></pre></div>
<pre><code>## $x
## [1] 0.0 0.5 1.0
## 
## $y
## [1] 0.0 0.5 1.0</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.5.0 
## ✔ readr   2.1.3      ✔ forcats 0.5.2 
## ✔ purrr   0.3.5      
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ✖ dplyr::select() masks MASS::select()</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),<span class="at">z=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">select_if</span>(data2,is.numeric), scale01)</span></code></pre></div>
<pre><code>## $x
## [1] 0.0 0.5 1.0
## 
## $y
## [1] 0.0 0.5 1.0</code></pre>
</div>
<div id="question2-2" class="section level3">
<h3>Question2</h3>
<p>Use vapply() to: a) Compute the standard deviation of every column in
a numeric data frame. b) Compute the standard deviation of every numeric
column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
</div>
<div id="answer2-3" class="section level3">
<h3>Answer2</h3>
<div id="a" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(data1, sd, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## x y 
## 1 1</code></pre>
</div>
<div id="b" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>( data2[,<span class="fu">which</span>(<span class="fu">vapply</span>(</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  data2,is.numeric,<span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>)))]</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  , sd, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## x y 
## 1 1</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data1,data2)</span></code></pre></div>
</div>
</div>
<div id="question3-1" class="section level3">
<h3>Question3</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9. (a)
Write an Rcpp function. (b) Compare the corresponding generated random
numbers with pure R language using the function “qqplot”. (c) Compare
the computation time of the two functions with the function
“microbenchmark”.</p>
</div>
<div id="answer3-1" class="section level3">
<h3>Answer3</h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<div id="a-1" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbs(double x01, double x02, int N = 1000){</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix x(N+1000, 2);</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="st">double rho = 0.9 ;</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="st">double mu1 = 0, mu2 = 0;</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="st">double sigma1 = 1, sigma2 = 1;</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="st">double s1 = sqrt(1-rho*rho)*sigma1 ;</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="st">double s2 = sqrt(1-rho*rho)*sigma2 ;</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="st">x(0,0) = x01, x(0,1) = x02;</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a><span class="st">for (int i=1; i&lt;N+1000; i++) {</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="st">  double x2 = x(i-1,1);</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a><span class="st">  double m1 = mu1 + rho * (x2 - mu2) * sigma1/sigma2;</span></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="st">  x(i,0) = rnorm(1, m1, s1)[0];</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="st">  double x1 = x(i,0);</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="st">  double m2 = mu2 + rho * (x1 - mu1) * sigma2/sigma1;</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="st">  x(i,1) = rnorm(1, m2, s2)[0];</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a><span class="st">return (x);</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(x01, x02, <span class="at">N =</span> <span class="dv">2000</span>){</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co"># the chain, a bivariate sample</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> </span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x01, x02) </span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (x)</span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="b-1" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(<span class="dv">100</span>,<span class="dv">10</span>)[<span class="fu">c</span>(<span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>),]</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(<span class="dv">100</span>,<span class="dv">10</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x[,<span class="dv">1</span>], y[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;qqplot of x1&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;from C&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;from R&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x[,<span class="dv">2</span>], y[,<span class="dv">2</span>],<span class="at">main=</span><span class="st">&quot;qqplot of x2&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;from C&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;from R&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From qqplot both generated random numbers corresponds the same
distribution.</p>
</div>
<div id="c" class="section level4">
<h4>(c)</h4>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">gibbsR</span>(<span class="dv">100</span>,<span class="dv">10</span>),</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="at">gibbC=</span><span class="fu">gibbs</span>(<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr       lq   median       uq
## 1 gibbR 5959.501 6532.051 8070.051
## 2 gibbC  447.751  455.051  466.201</code></pre>
<p>Function from C is much quicker than that from R.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x,y)</span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
